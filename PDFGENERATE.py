# -*- coding: iso-8859-1 -*-

import os
from datetime import date
import random
from pyfpdf import FPDF
import csv
import mmap
#List=open("fname.txt").readlines()
with open("fake.csv","r+b") as f:
     lis=[list(x.split(",")) for x in f]
     #mapout=mmap.mmap(f.fileno(),0)
     #L=list()
     #lis=[list(map(int,x.split(","))) for x in f]
     #for s in iter(mapout.readline,""):
      #    L.append(s)
     #print "List Length: ",len(lis)
     #print "List: ",lis[1][2]
#input("ENTER")
length=len(lis)-1;
for p in range(0,10000000):
    i=0
    j=22
    k=000000001
    pdf = FPDF()
    pdf.add_page()
    pdf.set_font('helvetica', '', 13.0)
    pdf.set_xy(105.0, 8.0)
    pdf.cell(ln=0, h=22.0, align='C', w=75.0, txt='Invoice# %s'%lis[random.randint(0,length)][0], border=0)
    pdf.set_line_width(0.0)
    pdf.rect(15.0, 15.0, 170.0, 245.0)
    pdf.set_line_width(0.0)
    pdf.rect(95.0, 15.0, 10.0, 10.0)
    #pdf.image('./logo.png', 20.0, 17.0, link='', type='', w=13.0, h=13.0)
    pdf.set_font('arial', 'B', 16.0)
    pdf.set_xy(95.0, 18.0)
    pdf.cell(ln=0, h=2.0, align='C', w=10.0, txt='X', border=0)
    pdf.set_font('arial', '', 8.0)
    pdf.set_xy(105.0, 21.0)
    pdf.cell(ln=0, h=4.0, align='C', w=75.0, txt=lis[random.randint(0,length)][7], border=0)
    pdf.set_font('arial', 'B', 7.0)
    pdf.set_xy(95.0, 21.5)
    pdf.cell(ln=0, h=4.5, align='C', w=10.0, txt='COD.00', border=0)
    pdf.set_line_width(0.0)
    pdf.line(100.0, 25.0, 100.0, 57.0)
    pdf.set_font('arial', 'B', 14.0)
    pdf.set_xy(125.0, 25.5)
    pdf.cell(ln=0, h=9.5, align='L', w=60.0, txt='0%d'%j, border=0)
    pdf.set_xy(115.0, 27.5)
    pdf.cell(ln=0, h=5.5, align='L', w=10.0, txt='N\xba: ', border=0)
    pdf.set_font('arial', 'B', 12.0)
    pdf.set_xy(17.0, 32.5)
    pdf.cell(ln=0, h=5.0, align='L', w=98.0, txt=lis[random.randint(0,length)][10], border=0)
    pdf.set_font('arial', '', 12.0)
    pdf.set_xy(115.0, 33.0)
    pdf.cell(ln=0, h=7.0, align='L', w=60.0, txt='Date:', border=0)
    pdf.set_xy(135.0, 33.0)

    start_date = date.today().replace(day=1, month=1,year=1990).toordinal()
    end_date = date.today().toordinal()
    random_day = date.fromordinal(random.randint(start_date, end_date))

    pdf.cell(ln=0, h=7.0, align='L', w=40.0, txt=random_day.strftime('%m/%d/%Y'), border=0)
    pdf.set_line_width(0.0)
    pdf.line(15.0, 57.0, 185.0, 57.0)
    pdf.set_font('times', '', 10.0)
    pdf.set_xy(17.0, 59.0)
    pdf.cell(ln=0, h=6.0, align='L', w=13.0, txt='Mr.(s):', border=0)
    pdf.set_xy(35.0, 59.0)
    pdf.cell(ln=0, h=6.0, align='L', w=140.0, txt=lis[random.randint(0,length)][2]+' '+lis[random.randint(0,length)][1], border=0)
    pdf.set_xy(17.0, 64.0)
    pdf.cell(ln=0, h=6.0, align='L', w=18.0, txt='Address:', border=0)
    pdf.set_xy(35.0, 64.0)
    pdf.cell(ln=0, h=6.0, align='L', w=125.0, txt=lis[random.randint(0,length)][3], border=0)
    pdf.set_xy(17.0, 69.0)
    pdf.cell(ln=0, h=6.0, align='L', w=18.0, txt='Tel\xe9fono:', border=0)
    pdf.set_xy(35.0, 69.0)
    pdf.cell(ln=0, h=6.0, align='L', w=80.0, txt=lis[random.randint(0,length)][6], border=0)
    pdf.set_xy(115.0, 69.0)
    pdf.cell(ln=0, h=6.0, align='L', w=18.0, txt='City:', border=0)
    pdf.set_xy(133.0, 69.0)
    pdf.cell(ln=0, h=6.0, align='L', w=42.0, txt=lis[random.randint(0,length)][4], border=0)
    pdf.set_line_width(0.0)
    pdf.line(15.0, 77.0, 185.0, 77.0)
    pdf.set_xy(17.0, 80.0)
    pdf.cell(ln=0, h=5.0, align='L', w=15.0, txt='VAT:', border=0)
    pdf.set_xy(35.0, 80.0)
    pdf.cell(ln=0, h=5.0, align='L', w=70.0, txt='Responsable', border=0)
    pdf.set_xy(115.0, 80.0)
    pdf.cell(ln=0, h=5.0, align='L', w=20.0, txt='Tax ID:', border=0)
    pdf.set_xy(135.0, 80.0)
    pdf.cell(ln=0, h=5.0, align='L', w=40.0, txt=lis[random.randint(0,length)][8], border=0)
    pdf.set_line_width(0.0)
    pdf.line(15.0, 88.0, 185.0, 88.0)
    pdf.set_xy(17.0, 90.0)
    pdf.cell(ln=0, h=5.0, align='L', w=48.0, txt='Due Date:', border=0)
    pdf.set_xy(65.0, 90.0)
    random_day = date.fromordinal(random.randint(start_date, end_date))
    pdf.cell(ln=0, h=5.0, align='L', w=20.0, txt=random_day.strftime('%m/%d/%Y'), border=0)
    pdf.set_xy(92.0, 90.0)
    pdf.cell(ln=0, h=5.0, align='L', w=43.0, txt='Period', border=0)
    pdf.set_xy(125.0, 90.0)
    random_day = date.fromordinal(random.randint(start_date, end_date))
    pdf.cell(ln=0, h=5.0, align='L', w=20.0, txt=random_day.strftime('%m/%d/%Y'), border=0)
    pdf.set_xy(150.0, 90.0)
    random_day = date.fromordinal(random.randint(start_date, end_date))
    pdf.cell(ln=0, h=5.0, align='L', w=20.0, txt=random_day.strftime('%m/%d/%Y'), border=0)
    pdf.set_line_width(0.0)
    pdf.line(15.0, 95.0, 185.0, 95.0)
    pdf.set_line_width(0.0)
    pdf.line(155.0, 95.0, 155.0, 230.0)
    pdf.set_xy(20.0, 97.0)
    pdf.cell(ln=0, h=5.0, align='L', w=125.0, txt='Description', border=0)
    pdf.set_xy(160.0, 97.0)
    pdf.cell(ln=0, h=5.0, align='R', w=20.0, txt='Amount', border=0)
    pdf.set_line_width(0.0)
    pdf.line(15.0, 102.0, 185.0, 102.0)
    pdf.set_xy(20.0, 103.0)
    pdf.cell(ln=0, h=7.0, align='L', w=125.0, txt='Esto es una prueba y no es v\xe1lido como factura', border=0)
    pdf.set_xy(160.0, 103.0)
    pdf.cell(ln=0, h=7.0, align='R', w=20.0, txt='100,00', border=0)
    ###

    pdf.set_xy(20.0, 109.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][12], border=0)
    pdf.set_xy(160.0, 109.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 115.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][11], border=0)
    pdf.set_xy(160.0, 115.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 121.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][9], border=0)
    pdf.set_xy(160.0, 121.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 127.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][5], border=0)
    pdf.set_xy(160.0, 127.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)

    pdf.set_xy(20.0, 133.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][12], border=0)
    pdf.set_xy(160.0, 133.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 139.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][11], border=0)
    pdf.set_xy(160.0, 139.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 145.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][9], border=0)
    pdf.set_xy(160.0, 145.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 151.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][5], border=0)
    pdf.set_xy(160.0, 151.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    
    
    pdf.set_xy(20.0, 157.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][12], border=0)
    pdf.set_xy(160.0, 157.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 163.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][11], border=0)
    pdf.set_xy(160.0, 163.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 169.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][9], border=0)
    pdf.set_xy(160.0, 169.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
####################
    
    pdf.set_xy(20.0, 175.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][12], border=0)
    pdf.set_xy(160.0, 175.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 181.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][11], border=0)
    pdf.set_xy(160.0, 181.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 187.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][9], border=0)
    pdf.set_xy(160.0, 187.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 193.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][5], border=0)
    pdf.set_xy(160.0, 193.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)

    pdf.set_xy(20.0, 199.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][12], border=0)
    pdf.set_xy(160.0, 199.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 205.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][11], border=0)
    pdf.set_xy(160.0, 205.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 211.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][9], border=0)
    pdf.set_xy(160.0, 211.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_xy(20.0, 217.0)
    pdf.cell(ln=0, h=9.0, align='L', w=125.0, txt=lis[random.randint(0,length)][5], border=0)
    pdf.set_xy(160.0, 217.0)
    pdf.cell(ln=0, h=9.0, align='R', w=20.0, txt='%d'%random.randint(0,1000000), border=0)
    

    ###
    pdf.set_line_width(0.0)
    pdf.line(15.0, 230.0, 185.0, 230.0)
    pdf.set_xy(20.0, 233.0)
    pdf.cell(ln=0, h=5.0, align='L', w=95.0, txt='CAE N\xba', border=0)
    pdf.set_xy(45.0, 233.0)
    pdf.cell(ln=0, h=5.0, align='L', w=30.0, txt=lis[random.randint(0,length)][9], border=0)
    pdf.set_font('arial', '', 12.0)
    pdf.set_xy(105.0, 234.0)
    pdf.cell(ln=0, h=9.0, align='R', w=45.0, txt='Subtotal:', border=0)
    pdf.set_font('arial', 'B', 12.0)
    pdf.set_xy(145.0, 234.0)
    pdf.cell(ln=0, h=9.0, align='R', w=33.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_font('arial', '', 10.0)
    pdf.set_xy(20.0, 238.0)
    pdf.cell(ln=0, h=5.0, align='L', w=95.0, txt='Fecha Vto. CAE:', border=0)
    pdf.set_xy(55.0, 238.0)
    random_day = date.fromordinal(random.randint(start_date, end_date))
    pdf.cell(ln=0, h=5.0, align='L', w=30.0, txt=random_day.strftime('%m/%d/%Y'), border=0)
    pdf.set_font('arial', '', 12.0)
    pdf.set_xy(125.0, 241.0)
    pdf.cell(ln=0, h=9.0, align='R', w=25.0, txt='VAT 21%:', border=0)
    pdf.set_font('arial', 'B', 12.0)
    pdf.set_xy(145.0, 241.0)
    pdf.cell(ln=0, h=9.0, align='R', w=33.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.interleaved2of5('012345678905', 20.0, 243.5, w=0.75)
    pdf.set_font('arial', 'B', 12.0)
    pdf.set_xy(105.0, 251.0)
    pdf.cell(ln=0, h=9.0, align='R', w=73.0, txt='%d'%random.randint(0,1000000), border=0)
    pdf.set_font('arial', '', 12.0)
    pdf.set_xy(125.0, 251.0)
    pdf.cell(ln=0, h=9.0, align='R', w=25.0, txt='Total:', border=0)
    pdf.set_line_width(0.0)
    pdf.rect(155.0, 252.0, 25.0, 7.0)
    pdf.set_font('courier', '', 10.0)
    pdf.set_xy(20.0, 253.0)
    pdf.cell(ln=0, h=7.0, align='L', w=120.0, txt=lis[random.randint(0,length)][12], border=0)
    pdf.output('%d.pdf'%p, 'F')
    print(p)
    

    #import sys
    #os.system("./invoice.pdf")
